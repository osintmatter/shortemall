```
   _____ _                _     _ ______                      _ _   _ 
  / ____| |              | |   ( )  ____|               /\   | | | | |
 | (___ | |__   ___  _ __| |_  |/| |__   _ __ ___      /  \  | | | | |
  \___ \| '_ \ / _ \| '__| __|   |  __| | '_ ` _ \    / /\ \ | | | | |
  ____) | | | | (_) | |  | |_    | |____| | | | | |  / ____ \| | | |_|
 |_____/|_| |_|\___/|_|   \__|   |______|_| |_| |_| /_/    \_\_|_| (_)
                                                                    
  by  OSINTMATTER                                                      
                                                                     v2.0
```
## Scope
*Short 'Em All!* is a Python tool that allows analysts to do lookups of URLs generated by almost every Url Shortener Service out there.
You can generate custom URLs based on your custom dictionary or input keywords, check for active links containing one or more words (with any possible permutation automatically generated), and get screenshots of the content on them.
Short' Em All!, finally, allows you to get a .txt report with active urls for single scan and related keywords.

## What's new in V2.0

1. The logic of the tool has evolved from a single-scan system toward continuous monitoring of Short-URLs digital footprint 
2. E-mail notification on newly found urls 
3. Automatic screenshot of landing pages without Chrmodriver 
4. Google Developers functions fully implemented with minimal manual requirement for configuration 

Video tutorial on V2.0 features here: https://twitter.com/MatterOsint/status/1567455974717276165 

## Prerequisites
Before you begin, ensure you have met the following requirements:

* You have installed Python - pip (at least v. 3.8) 
* You run the tool on Linux machine or Linux Virtual Host 
* You have obtained the OAuth 2.0 client ID on your gmail account (preferably use a new account) - follow this step-by-step guide: https://support.google.com/cloud/answer/6158849?hl=en#zippy= 
NOTE: remember to save the generated Google credentials file in /shortemall main folder and rename it credentials.json 
* You created your Google Search Console API Key - follow this step-by-step guide : https://developers.google.com/webmaster-tools/search-console-api/v1/configure


## Installing
1. Edit the config.py on the variables section. On "my_email", "to_email" and "api_key"
2. Run config.py to automatically generate path variables
3. Open terminal on /shortemall/ and run: pip install -r requirements.txt
4. Run gmail_config.py
5. A pop-up browser window appers, then select the google account name where you created the OAuth 2.0 client ID 
6. Grant access to the app by pressing continue (there is no security problem since it is a tool that runs exclusively locally and is totally managed by the end user)
7. Flag the two boxes requiring to Send/Read/Compose email on your behalf
8. If you see on screen "The authentication flow has completed. You may close this window." then you have successfully created your gmail.pickle file for OAUTH2.0 (don't move it)
9. Go to /Short\_Em\_All, and on terminal run: python3 short\_em\_all.py

## Stable_dict.txt
On /Input folder you will find stable_dict.txt. This is your living dictionary, you can manually edit the .txt file with keyword list (one per line). The stable_dict can be your baseline for scheduled jobs or ricursive scans. 

## CLI Options

usage: short_em_all.py [-h] [-t TARGET] [-d [DICTIONARY]] [-n [NOTIFICATIONS]] [-z [ZERO]] [-a [ALL]] [-r [SINGLESCAN]] [-e [EMAIL]] [-s [SCREENSHOT]] [-v [VERBOSE]]

optional arguments: 

	-h, --help
	show this help message and exit
	
	- t, --target
	insert target keyword for this scan
	
	- d, --dictionary
	use stable_dictionary for this scan
	
	-n, --notifications
	don't send email notifications on found results
	
	-z, --zero
	don't take screenshots on URLs landing pages
	
	-f, --found
	show only found results
	
	-r, --singlescan
	use single scan mode (no retention)
	
	-e, --email
	receive email notification on target scan
	
	-s, --screenshot
	Take screenshots on found results
	
	-v, --verbose
	turn on verbose mode
    """
## RUN Options

If you want to execute the script without CLI options:

```
python3 shortemall.py 
```

Then, you con manually configure some scan options: 

```
[*] Do you want to use the dict.txt file to generate URLs? (y: Yes, n: No)
```

  [-] Yes: use the stable\_dict.txt (Short\_Em\_All\Input)
  
  [-] No: insert keyword to run a scan based on single-target
		
```
[*] Do you want to take screenshot for found URLs? (y: Yes, n: No)
```

  [-] Yes: URLs with HTTP Status Code = 200 are screenshotted and saved into /Screenshot
  
  [-] No: no screenshot taken during the scan process
		
```
[*] Do you want to see only existing URLs? (y: Yes, n: No)
```

  [-] Yes: only URLs with HTTP Status Code = 200 are printed on-screen
  
  [-] No: all results are printed on-screen
  
```
 [*] Do you want to receive email notification on target scan results? (y: Yes, n: No)
```
  [-] Yes: in case new results will be find into the scan you will receive an e-mail notification (on "to_mail" adress you edited in config.py) 
  
  [-] No: no e-mail notification will be sent 

```
[*] Do you want to use single scan mode with no data retention? (y: Yes, n: No)
```
  [-] Yes: the scan-results will not be written into the infile.txt and so will not affect the urls collection 
  
  [-] No: scan-results will be written into the infile.txt and will enrich the urls collection 
  

## Notes
Due to presence of false postivies on found URLs, I strongly suggest to enable the screenshots option. This way you can visually filter the results once the scan is terminated. 

## Acknowledgements

The URL verification method implemented in *Short 'Em All!* uses https://seintpl.github.io/osint/short-links-verification-cheatsheet as its dynamic source generation. 

## Disclaimer 

*Short'em All!* avoids generating unwanted direct traffic to "Short Urls Providers" by using only a preview mode for each individual URL generated. In any case, limited and conscious use of scans is recommended.
The tool is intended for educational and research purposes. 

## Contact Info

for any question or further information write to me at: info@osintmatter.com

You can find me on Twitter: https://twitter.com/MatterOsint 

Soon on ... osintmatter.com

